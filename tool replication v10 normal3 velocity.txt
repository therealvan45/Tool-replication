workspace.FallenPartsDestroyHeight = 0/0
local localPlayer = game:GetService("Players").LocalPlayer
local character = localPlayer.Character
local tools = {}
local getRandomPlayer = function()
	local cPlayers = game:GetService("Players"):GetPlayers()
	table.remove(cPlayers, table.find(cPlayers, localPlayer))
	return cPlayers[math.random(#cPlayers)]
end
for _, object in pairs(localPlayer.Backpack:GetChildren()) do
	if object:FindFirstChild("Handle") then
		table.insert(tools, object)
	end
end
character.Archivable = true
character.Humanoid.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None
local fakeCharacter = character:Clone()
fakeCharacter.Parent = game.ReplicatedStorage
for _, tool in pairs(tools) do
	tool.Parent = character
end
replicatesignal(localPlayer.ConnectDiedSignalBackend)
game:GetService("StarterGui"):SetCore("SendNotification", {
	Title = "Tool replication v10",
	Text = "therealvan45 modified it. Credits to original script creator",
	Duration = game:GetService("Players").RespawnTime
})
task.wait(game:GetService("Players").RespawnTime + 0.2)
replicatesignal(localPlayer.Kill)
task.wait(localPlayer:GetNetworkPing() * 2)
for _, tool in pairs(tools) do
	tool.Parent = localPlayer.Backpack
end
task.wait(localPlayer:GetNetworkPing() * 2)
for _, tool in pairs(tools) do
	tool.Parent = character
end
local step = game:GetService("RunService").Stepped:Connect(function()
	for _, object in pairs(fakeCharacter:GetDescendants()) do
		if object:IsA("BasePart") then
			--  object.Transparency = 0.5
			-- object.CanCollide = false
		end
	end
	for _, object in pairs(character:GetDescendants()) do
		if object:IsA("BasePart") then
			-- object.CanCollide = false
		end
	end
end)
local c; c = game:GetService("RunService").Heartbeat:Connect(function()
	localPlayer.SimulationRadius = math.huge
    localPlayer.Character.Humanoid.MaxHealth = math.huge
    localPlayer.Character.Humanoid.Health = math.huge
	local allChildren = {}
	local added = {}
	local function addPart(part)
		if part and part.Parent and part.Transparency < 1 and not added[part] then
			table.insert(allChildren, part)
			added[part] = true
		end
	end
	-- Add main body parts if visible
	if fakeCharacter:FindFirstChild("Right Leg") then
		addPart(fakeCharacter["Right Leg"])
	end
	if fakeCharacter:FindFirstChild("Left Leg") then
		addPart(fakeCharacter["Left Leg"])
	end
	if fakeCharacter:FindFirstChild("Torso") then
		addPart(fakeCharacter["Torso"])
	end
	if fakeCharacter:FindFirstChild("Right Arm") then
		addPart(fakeCharacter["Right Arm"])
	end
	if fakeCharacter:FindFirstChild("Left Arm") then
		addPart(fakeCharacter["Left Arm"])
	end
	if fakeCharacter:FindFirstChild("Head") then
		addPart(fakeCharacter["Head"])
	end
	-- Add from "gay" objects directly under fakeCharacter
	for _, obj in pairs(fakeCharacter:GetChildren()) do
		if obj.Name == "gay" then
			if obj:IsA("BasePart") then
				addPart(obj)
			end
			for _, descendant in pairs(obj:GetDescendants()) do
				if descendant:IsA("BasePart") then
					addPart(descendant)
				end
				if descendant:IsA("Instance") then --you can change the instance
					for useless,kakashkas in pairs(descendant:GetDescendants()) do
						if kakashkas:IsA("BasePart") then
							addPart(kakashkas)
						end
					end
				end
			end
		end
	end
	-- Also search for "gay" models inside character's limbs
	local limbs = {"Left Arm", "Right Arm", "Head", "Torso", "Left Leg", "Right Leg"}
	for _, limbName in pairs(limbs) do
		local limb = fakeCharacter:FindFirstChild(limbName)
		if limb then
			for _, obj in pairs(limb:GetChildren()) do
				if obj.Name == "gay" then
					if obj:IsA("BasePart") then
						addPart(obj)
					end
					for _, descendant in pairs(obj:GetDescendants()) do
						if descendant:IsA("BasePart") then
							addPart(descendant)
						end
						if descendant:IsA("Instance") then --you can change the instance
							for useless,kakashkas in pairs(descendant:GetDescendants()) do
								if kakashkas:IsA("BasePart") then
									addPart(kakashkas)
								end
							end
						end
					end
				end
			end
		end
	end
	for index, tool in ipairs(tools) do
		if not tool:FindFirstChild("Handle") then
			continue
		end
		if allChildren[index] then
			tool.Handle.CFrame = allChildren[index].CFrame
			tool.Handle.CanCollide = false
			-- tool.Handle.Velocity = Vector3.one * 30
            tool.Handle.AssemblyLinearVelocity = Vector3.one * 27
		end
	end
end)
fakeCharacter.Parent = workspace
character.Parent = fakeCharacter
fakeCharacter.Humanoid.Died:Connect(function()
	character.Parent = workspace
	localPlayer.Character = character
	step:Disconnect()
	c:Disconnect()
	for _, tool in pairs(tools) do
		tool:Destroy()
	end
	task.wait()
	fakeCharacter:Destroy()
	workspace.CurrentCamera.CameraSubject = character
	replicatesignal(localPlayer.ConnectDiedSignalBackend)
	game:GetService("StarterGui"):SetCore("SendNotification", {
		Title = "tf",
		Text = "please wait respawning",
		Duration = game:GetService("Players").RespawnTime
	})
end)
localPlayer.Character = fakeCharacter
workspace.CurrentCamera.CameraSubject = fakeCharacter
fakeCharacter.Animate.Disabled = true
task.wait(0.1)
fakeCharacter.Animate.Disabled = false
if not fakeCharacter:FindFirstChild("gay") then
	fakeCharacter:WaitForChild("gay")
end